using System;
using System.Security.Cryptography;
using System.Security.Cryptography.X509Certificates;

namespace Net.Helper
{
    public class CertificateHelper
    {
        /// <summary>
        /// 开发调式阶段证书数据
        /// </summary>
        public readonly static byte[] CertificateData = new byte[]
        {
            48, 130, 6, 82, 2, 1, 3, 48, 130, 6, 14, 6, 9, 42, 134, 72, 134, 247, 13, 1,
            7, 1, 160, 130, 5, 255, 4, 130, 5, 251, 48, 130, 5, 247, 48, 130, 3, 72, 6, 9,
            42, 134, 72, 134, 247, 13, 1, 7, 1, 160, 130, 3, 57, 4, 130, 3, 53, 48, 130, 3,
            49, 48, 130, 3, 45, 6, 11, 42, 134, 72, 134, 247, 13, 1, 12, 10, 1, 2, 160, 130,
            2, 166, 48, 130, 2, 162, 48, 28, 6, 10, 42, 134, 72, 134, 247, 13, 1, 12, 1, 3,
            48, 14, 4, 8, 141, 25, 10, 26, 120, 250, 98, 142, 2, 2, 7, 208, 4, 130, 2, 128,
            222, 136, 198, 244, 43, 159, 0, 94, 7, 102, 0, 30, 222, 108, 147, 63, 166, 249, 31, 131,
            129, 50, 121, 89, 152, 229, 1, 163, 201, 212, 199, 246, 133, 65, 81, 78, 192, 143, 28, 40,
            186, 101, 183, 177, 143, 135, 123, 246, 196, 199, 59, 149, 223, 116, 121, 129, 50, 113, 59, 33,
            89, 54, 230, 72, 177, 72, 55, 182, 96, 90, 194, 247, 7, 144, 162, 103, 144, 229, 233, 104,
            153, 29, 110, 192, 54, 168, 231, 32, 137, 209, 126, 49, 228, 11, 246, 200, 86, 54, 23, 104,
            86, 188, 254, 166, 57, 65, 55, 199, 150, 220, 198, 135, 31, 199, 20, 7, 61, 245, 175, 26,
            150, 182, 197, 8, 79, 250, 229, 245, 200, 160, 59, 233, 118, 220, 128, 42, 158, 150, 53, 62,
            110, 254, 7, 79, 66, 238, 248, 86, 71, 254, 8, 50, 73, 235, 95, 198, 29, 138, 25, 98,
            219, 191, 151, 242, 53, 149, 40, 154, 210, 26, 72, 132, 96, 14, 180, 88, 126, 10, 233, 17,
            15, 204, 50, 252, 180, 141, 42, 171, 103, 47, 147, 245, 98, 52, 83, 113, 140, 213, 206, 67,
            142, 21, 20, 182, 203, 84, 10, 27, 248, 234, 3, 30, 42, 46, 24, 171, 142, 26, 62, 198,
            30, 48, 141, 19, 18, 48, 159, 192, 63, 107, 115, 253, 74, 3, 0, 133, 213, 49, 96, 252,
            109, 74, 184, 151, 220, 34, 26, 18, 239, 234, 193, 59, 241, 56, 165, 175, 154, 65, 160, 140,
            50, 11, 98, 175, 30, 232, 35, 121, 254, 193, 39, 126, 113, 213, 169, 74, 29, 182, 106, 60,
            247, 162, 99, 95, 207, 52, 37, 51, 119, 188, 226, 121, 29, 117, 223, 198, 210, 7, 111, 161,
            124, 176, 220, 101, 253, 57, 59, 124, 14, 111, 120, 71, 112, 46, 243, 168, 23, 174, 30, 4,
            234, 53, 118, 215, 145, 197, 83, 211, 227, 68, 43, 158, 233, 9, 22, 150, 108, 99, 123, 27,
            128, 230, 24, 89, 227, 182, 188, 95, 207, 60, 109, 21, 50, 98, 66, 72, 50, 225, 191, 214,
            116, 188, 148, 144, 39, 41, 125, 18, 221, 124, 231, 162, 255, 60, 215, 152, 20, 16, 192, 72,
            254, 10, 153, 118, 192, 93, 81, 123, 216, 166, 143, 117, 73, 1, 40, 40, 16, 169, 28, 118,
            111, 40, 211, 140, 121, 67, 90, 118, 64, 193, 215, 234, 206, 39, 169, 79, 76, 89, 231, 25,
            32, 53, 79, 71, 4, 156, 58, 74, 157, 164, 213, 153, 31, 248, 39, 123, 243, 105, 157, 205,
            128, 96, 253, 135, 79, 156, 228, 110, 201, 239, 150, 3, 153, 210, 225, 114, 49, 183, 181, 117,
            228, 230, 8, 240, 218, 164, 168, 169, 240, 89, 208, 156, 121, 251, 103, 197, 251, 114, 90, 212,
            136, 95, 194, 240, 222, 30, 249, 185, 204, 155, 71, 146, 23, 53, 8, 17, 54, 64, 152, 194,
            136, 35, 115, 25, 108, 43, 98, 195, 166, 186, 221, 6, 55, 217, 90, 237, 171, 159, 236, 122,
            111, 29, 110, 175, 120, 178, 249, 165, 250, 32, 212, 182, 16, 89, 34, 31, 24, 243, 155, 196,
            163, 221, 142, 81, 139, 183, 94, 158, 166, 23, 205, 43, 14, 185, 172, 32, 111, 62, 135, 60,
            16, 144, 238, 101, 76, 69, 180, 103, 123, 15, 86, 190, 197, 233, 228, 80, 14, 150, 210, 226,
            221, 64, 158, 227, 94, 253, 104, 84, 119, 14, 173, 83, 8, 140, 151, 221, 68, 205, 162, 105,
            241, 126, 32, 15, 115, 57, 251, 161, 234, 172, 58, 119, 62, 204, 187, 150, 252, 175, 189, 72,
            172, 225, 10, 16, 13, 66, 21, 168, 142, 188, 90, 120, 86, 168, 212, 214, 212, 137, 199, 152,
            49, 116, 48, 19, 6, 9, 42, 134, 72, 134, 247, 13, 1, 9, 21, 49, 6, 4, 4, 1,
            0, 0, 0, 48, 93, 6, 9, 43, 6, 1, 4, 1, 130, 55, 17, 1, 49, 80, 30, 78,
            0, 77, 0, 105, 0, 99, 0, 114, 0, 111, 0, 115, 0, 111, 0, 102, 0, 116, 0, 32,
            0, 83, 0, 111, 0, 102, 0, 116, 0, 119, 0, 97, 0, 114, 0, 101, 0, 32, 0, 75,
            0, 101, 0, 121, 0, 32, 0, 83, 0, 116, 0, 111, 0, 114, 0, 97, 0, 103, 0, 101,
            0, 32, 0, 80, 0, 114, 0, 111, 0, 118, 0, 105, 0, 100, 0, 101, 0, 114, 48, 130,
            2, 167, 6, 9, 42, 134, 72, 134, 247, 13, 1, 7, 6, 160, 130, 2, 152, 48, 130, 2,
            148, 2, 1, 0, 48, 130, 2, 141, 6, 9, 42, 134, 72, 134, 247, 13, 1, 7, 1, 48,
            28, 6, 10, 42, 134, 72, 134, 247, 13, 1, 12, 1, 3, 48, 14, 4, 8, 254, 68, 144,
            139, 27, 15, 126, 188, 2, 2, 7, 208, 128, 130, 2, 96, 70, 2, 217, 52, 172, 147, 203,
            250, 108, 239, 157, 113, 87, 199, 83, 230, 13, 206, 35, 140, 228, 211, 136, 137, 142, 210, 28,
            240, 255, 227, 29, 176, 52, 201, 24, 96, 173, 250, 27, 155, 191, 61, 45, 229, 243, 155, 51,
            129, 12, 252, 26, 116, 198, 42, 242, 13, 77, 20, 248, 229, 28, 38, 187, 21, 194, 194, 52,
            238, 7, 40, 52, 35, 166, 233, 178, 16, 123, 243, 146, 119, 198, 82, 97, 119, 134, 130, 120,
            58, 244, 163, 57, 56, 177, 176, 116, 64, 67, 213, 81, 5, 112, 8, 2, 7, 117, 110, 107,
            128, 204, 214, 209, 127, 0, 102, 213, 101, 78, 226, 165, 66, 160, 90, 54, 236, 83, 191, 45,
            191, 28, 125, 174, 129, 133, 92, 221, 75, 75, 73, 167, 155, 227, 198, 97, 241, 23, 40, 141,
            161, 239, 207, 186, 84, 131, 26, 36, 131, 247, 248, 186, 128, 177, 129, 88, 88, 138, 94, 75,
            150, 201, 60, 151, 78, 174, 233, 106, 192, 139, 242, 215, 25, 138, 123, 163, 254, 83, 148, 193,
            104, 71, 99, 231, 193, 105, 232, 130, 41, 15, 116, 88, 179, 100, 177, 15, 140, 252, 58, 168,
            118, 217, 25, 225, 82, 6, 50, 28, 215, 149, 190, 245, 106, 43, 31, 160, 31, 38, 177, 107,
            234, 237, 7, 113, 183, 95, 36, 229, 112, 33, 24, 238, 107, 20, 185, 20, 102, 233, 216, 79,
            25, 190, 163, 241, 88, 103, 218, 77, 20, 213, 167, 214, 232, 212, 241, 83, 157, 205, 120, 205,
            186, 243, 39, 151, 189, 224, 255, 89, 39, 137, 80, 52, 130, 189, 7, 72, 68, 198, 151, 18,
            23, 25, 86, 133, 69, 99, 182, 71, 167, 41, 240, 129, 238, 195, 204, 254, 130, 78, 129, 20,
            230, 50, 155, 153, 39, 114, 163, 39, 6, 42, 161, 101, 66, 213, 186, 107, 14, 34, 125, 27,
            168, 194, 140, 113, 144, 112, 95, 33, 148, 138, 184, 147, 118, 171, 67, 237, 212, 231, 223, 41,
            141, 200, 132, 12, 228, 108, 173, 165, 254, 255, 216, 159, 99, 109, 31, 232, 244, 169, 109, 44,
            154, 138, 181, 8, 220, 141, 106, 201, 57, 158, 136, 25, 97, 115, 206, 208, 196, 102, 6, 215,
            232, 6, 131, 159, 72, 231, 111, 12, 227, 62, 254, 55, 93, 137, 57, 44, 80, 216, 65, 240,
            142, 15, 227, 171, 205, 102, 96, 111, 173, 213, 69, 159, 252, 207, 41, 41, 130, 158, 114, 158,
            15, 13, 239, 132, 97, 137, 187, 10, 227, 143, 181, 64, 94, 244, 26, 199, 140, 96, 128, 242,
            125, 105, 170, 142, 107, 86, 217, 37, 90, 229, 48, 66, 205, 30, 252, 38, 16, 44, 209, 37,
            149, 100, 190, 107, 73, 238, 158, 135, 72, 166, 143, 191, 202, 216, 94, 174, 151, 32, 84, 179,
            180, 28, 113, 180, 231, 80, 7, 42, 30, 200, 89, 238, 72, 124, 251, 66, 139, 69, 55, 209,
            222, 255, 219, 13, 127, 128, 220, 179, 192, 177, 241, 235, 20, 225, 28, 131, 102, 211, 30, 221,
            189, 54, 153, 6, 158, 74, 208, 223, 196, 254, 72, 75, 92, 152, 162, 23, 120, 254, 168, 38,
            232, 218, 232, 153, 253, 255, 150, 61, 127, 182, 236, 66, 200, 3, 69, 164, 135, 177, 142, 105,
            228, 246, 136, 145, 89, 49, 125, 54, 244, 217, 139, 172, 20, 186, 249, 83, 12, 82, 26, 229,
            213, 74, 235, 36, 124, 197, 130, 144, 148, 156, 109, 244, 211, 21, 24, 119, 181, 109, 244, 117,
            141, 48, 59, 48, 31, 48, 7, 6, 5, 43, 14, 3, 2, 26, 4, 20, 25, 27, 149, 224,
            197, 16, 53, 191, 76, 57, 176, 44, 183, 177, 169, 182, 72, 64, 141, 181, 4, 20, 83, 231,
            243, 248, 79, 117, 227, 101, 35, 156, 221, 178, 77, 254, 46, 83, 29, 153, 171, 110, 2, 2,
            7, 208
        };

        public static X509Certificate2 CreateX509Certificate2()
        {
#if UNITY_2021_1_OR_NEWER || SERVICE
            // 创建一个新的RSA密钥对，用于证书
            using (RSA rsa = RSA.Create())
            {
                var request = new CertificateRequest("CN=gdnet_websocket_certificate", rsa, HashAlgorithmName.SHA256, RSASignaturePadding.Pkcs1);
                // 设置证书的有效期
                request.CertificateExtensions.Add(new X509BasicConstraintsExtension(false, false, 0, false));
                // 创建自签名证书
                var certificate = request.CreateSelfSigned(DateTimeOffset.Now.AddDays(-1), DateTimeOffset.Now.AddYears(1));
                // 将证书导出到文件（可选）
                var certData = certificate.Export(X509ContentType.Pkcs12, "gdnet_certificate");
                return new X509Certificate2(certData, "gdnet_certificate");
            }
#else
            return null;
#endif
        }

        public static X509Certificate2 GetDefaultCertificate()
        {
            return new X509Certificate2(CertificateData, "gdnet_certificate");
        }
    }
}
